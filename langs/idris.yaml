id: "idris"
aliases:
  - "idr"
  - "idris2"
name: "Idris"

install:
  prepare:
    apt:
      - chezscheme
  apt:
    - chezscheme
  manual: |
    wget https://www.idris-lang.org/idris2-src/idris2-latest.tgz
    mkdir idris
    tar -xf idris2-latest.tgz -C idris --strip-components=1
    pushd idris
    make bootstrap-build SCHEME=chezscheme PREFIX="${pkg}/usr/local"
    make install PREFIX="${pkg}/usr/local"
    chmod -R a=u,go-w "${pkg}/usr/local"/idris2-*
    popd

repl: |
  rm -f .idris/repl/init; idris2

main: "Main.idr"
template: |
  module Main

  main : IO ()
  main = putStrLn "Hello, world!"

run: |
  mkdir -p .idris/repl; echo ':exec main' > .idris/repl/init; idris2 Main.idr -x main; idris2 Main.idr

scope:
  code: |
    x : Int
    x = 123 * 234
